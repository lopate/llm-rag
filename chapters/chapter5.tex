\chapter{Формула Тейлора с остаточным членом в форме Пеано или Лагранжа.}

\section[Подготовительные определения]{Подготовительные определения\footnote{Заранее предупрежу, что будут предложены два подхода к изложению материала данной главы.}}\label{ch5:sectearldefs}

Пусть функция $f(x)$ определена в некоторой окрестности точки $x_0$ и в точке $x_0$ имеет $n$-ю производную, а следовательно, и все производные до~$n$-го порядка. Легко видеть, что многочлен
$$
P_n(x) = \sum_{k = 0}^{n} \frac{f^{(k)}(x_0)}{k!} (x - x_0)^k
$$
обладает следующим свойством:
$$
P_n^{(k)}(x_0) = f^{(k)}(x_0) \quad \forall k \in \overline{0,n}.
$$

\begin{defn}
Этот многочлен $P_n(x)$ называется \textit{многочленом Тейлора функции $f$ в точке $x_0$}. Равенство $$
f(x) = P_n(x) + r_n(x) = \sum_{k = 0}^{n} \frac{f^{(k)}(x_0)}{k!} (x - x_0)^k + r_n(x)
$$ 
называется \textit{формулой Тейлора}\rindex{формула!Тейлора} для функции $f(x)$ в точке $x_0$. При этом $$\frac{f^{(k)}(x_0)}{k!} (x - x_0)^k$$ называется \textit{$k$-м членом} формулы Тейлора, а функция $r_n(x)$ "--- остаточным членом формулы Тейлора (он идет после $n$-го члена).
\end{defn}

Иногда, чтобы указать, что многочлен Тейлора построен для конкретной функции~$f$ пишут~$P_n(f;x)$,~$r_n(f;x)$ вместо $P_n(x)$,~$r_n(x)$, или даже $P_n(f;x_0;x)$,~$r_n(f;x_0;x)$, обращая внимание на точку~$x_0$.

В частном случае $x_0=0$ формулу Тейлора называют \textit{формулой Маклорена}.

Напоследок, нам пригодится следующее определение:
\begin{defn}
Пусть функции $f(x)$ и $g(x)$ определены на множестве $X$, и пусть $x_0$ "--- предельная точка множества $X$ (конечная или бесконечная). Говорят, что \textit{функция~$f(x)$ есть $o$-малое от $g(x)$ при $x\to x_0$}, и пишут
$$
f(x) = o(g(x)) \text{ при } x\to x_0,
$$ 
если в некоторой окрестности точки $x_0$ для любого $x \in X$, $x\ne x_0$ выполняется неравенство\footnotemark
$$
|f(x)| \le \alpha(x)|g(x)|,
$$
где функция $\alpha(x)$ "--- бесконечно малая при $x\to x_0$, т.е.~$\lim\limits_{x\to x_0}\alpha(x)= 0$.
\end{defn}

\footnotetext{Однако можно заметить, что в этом параграфе везде мы будем указывать случай равенства. То есть будем рассматривать частный случай, в котором $f(x) = o(g(x)) =\alpha(x)g(x) $, где $\alpha(x)\xrightarrow{x\to x_0} 0$. Заметим, что для удобства некоторые авторы так и определяют понятие $o$-малое. А также точка $x_0$ будет всегда конечной.}

\section{Формула Тейлора с остаточным членом в форме Пеано или Лагранжа}
	
\begin{thm} \label{ch5.thm1}
Если функция $f(x)$ в некоторой окрестности $O(x_0)$ точки $x_0$ имеет непрерывную производную $n$-го порядка и $f^{(n)}(x)$ дифференцируема в проколотой окрестности $\overset{\circ}{O}(x_0)$, то для любого
$x \in \overset{\circ}{O}(x_0)$ существует $\xi$, лежащее строго между $x$ и $x_0$ и такое, что справедливо равенство
\begin{equation} \label{ch5.1eq1}
f(x) = \sum_{k = 0}^{n} \frac{f^{(k)}(x_0)}{k!}(x - x_0)^k + \frac{f^{(n + 1)}(\xi)}{(n + 1)!}(x - x_0)^{n + 1}.
\end{equation}
\end{thm}

\begin{proof}
Функции $$r_n(x) = f(x) - P_n(x) \quad \text{и} \quad \phi(x) = (x - x_0)^{n + 1}$$ удовлетворяют всем условиям следствия~\ref{ch4.1cons5} из теоремы Коши о среднем (глава~\textnumero\ref{chapter4}]). Кроме того, 
$$
r_n^{(k)}(x_0) = 0, \quad \phi^{(k)}(x_0) = 0 \quad \forall k \in \overline{0,n}.
$$ 
Поэтому, если $x \in O(x_0)$ и, например, $x < x_0$, то существует $\xi_1 \in (x; x_0)$ такое, что
$$
\frac{r_n(x)}{\phi(x)} = \frac{r_n(x) - r_n(x_0)}{\phi(x) - \phi(x_0)} = \frac{r_n'(\xi_1)}{\phi'(\xi_1)}.
$$
Аналогично,
$$
\exists \xi_2 \in (\xi_1; x_0)\cquad \frac{r_n'(\xi_1)}{\phi'(\xi_1)} = \frac{r_n''(\xi_2)}{\phi''(\xi_2)}.
$$

$$\ldots\ldots\ldots (\text{до тех пор пока есть производные})$$

$$
\exists \xi_n \in (\xi_{n - 1}; x_0) \cquad \frac{r_n^{(n - 1)}(\xi_{n - 1})}{\phi^{(n - 1)}(\xi_{n - 1})} = \frac{r_n^{(n)}(\xi_{n})}{\phi^{(n)}(\xi_{n})}.
$$
Легко видеть, что 
$$
\phi^{(n)}(x) = (n + 1)!(x - x_0),
$$
$$
r_n^{(n)}(x) = f^{(n)}(x) - f^{(n)}(x_0).
$$

К этим функциям на отрезке $[\xi_n; x_0]$ снова применим теорему о среднем:
$$
\exists \xi \in (\xi_n; x_0)\cquad \frac{r_n^{(n)}(\xi_{n})}{\phi^{(n)}(\xi_{n})} = \frac{r_n^{(n + 1)}(\xi)}{\phi^{(n + 1)}(\xi)} = \frac{f^{(n + 1)}(\xi)}{(n + 1)!}.
$$

Следовательно, $\exists \xi \in (x; x_0)$ такое, что
$$
\frac{r_n(x)}{\phi(x)} = \frac{f^{(n + 1)}(\xi)}{(n + 1)!},
$$
$$
r_n(x) = \frac{f^{(n + 1)}(\xi)}{(n + 1)!}(x - x_0)^{n + 1}.
$$

Аналогично рассматривается и случай $x > x_0$. Теорема доказана.
\end{proof}

Равенство $\eqref{ch5.1eq1}$ называется \textit{формулой Тейлора с остаточным членом в форме Лагранжа}.

\begin{defn}
Функция, которая задается формулой 
$$
y = g(f(x)),
$$
где $f$ и $g$ "--- данные функции, называется \textit{сложной функцией} или \textit{композицией} (иногда \textit{суперпозицией}) функций $f$ и $g$.
\end{defn}

\begin{thm}
Если функция $\phi(x)$ имеет предел при $x \to x_0$ и он равен $y_0$, а функция $f(y)$ имеет предел при $y \to y_0$ и, кроме того, $\forall x \in D_\phi \quad \phi(x) \in D_f, \: \phi(x) \not= y_0$, то сложная функция $f(\phi(x))$ имеет предел при $x \to x_0$ и
\begin{equation} \label{ch5.1eq3}
\lim_{x \to x_0} f(\phi(x)) = \lim_{y \to y_0} f(y).
\end{equation}
\end{thm}

\begin{proof}
Пусть последовательность $\{ x_n \}$ такая, что 
$$
\forall n\in \bbN \quad x_n \in D_{\phi}, \quad x_n \not= x_0 \quad \text{и} \quad \lim_{n \to \infty} x_n = x_0.
$$
Тогда последовательность $y_n = \phi(x_n)$ сходится к $y_0$ при $n \to \infty$ и 
$$
\lim_{n \to \infty} f(\phi(x_n)) = \lim_{n \to \infty} f(y_n) = \lim_{y \to y_0} f(y).
$$

Теорема доказана.
\end{proof}

Формула \eqref{ch5.1eq3} называется \textit{формулой замены переменного под знаком предела}. В ней $x_0$ и все рассматриваемые пределы могут быть как конечными, так и бесконечными.

\begin{thm}
Если функция $f$ дифференцируема $n$ раз в точке $x_0 \in \bbR$, то справедливо равенство
\begin{equation} \label{ch5.2eq2}
f(x) = \sum_{k = 0}^{n} \frac{f^{(k)}(x_0)}{k!} (x - x_0)^k + o((x - x_0)^n), \quad \text{при } x \to x_0,
\end{equation}
где $\psi(x) = o((x - x_0)^n),\ x \to x_0 \leftrightarrow \psi(x) = \alpha(x) (x - x_0)^n,$ где $\lim\limits_{x \to x_0} \alpha(x) = 0$.
\end{thm}

Формула~\eqref{ch5.2eq2} называется \textit{формулой Тейлора для $f$ в точке $x_0$ порядка~$n$ с остаточным членом в форме Пеано.}

\begin{proof}
Функция $f$ дифференцируема $n$ раз в точке $x_0$. Следовательно, функция $f^{(n - 1)}(x)$ определена в некоторой окрестности $O(x_0)$ точки $x_0$, т.е. $\exists f^{(n)}(x_0) \in \bbR: \quad$
$ \exists f^{(k)}(x_0) \in \bbR, \quad \text{где} \quad k \in \overline{0,n - 1}$

Рассмотрим функции $r_n(x) = f(x) - P_n(x), \quad \phi(x) = (x - x_0)^n$
$$
r_n^{(k)}(x) = 0, \quad \forall k \in \overline{0,n}, \quad \phi^{(k)}(x_0) = 0, \quad \forall k \in \overline{0, n-1}, \quad \phi^{(k)}(x) \not= 0, \quad x \not= x_0.
$$ 

Согласно теореме Коши и следствию~\ref{ch4.1cons5} из предыдущей главы все так же, как и в теореме~\ref{ch5.thm1} (про формулу Тейлора с остаточным членом в форме Лагранжа).

$\forall x \in \overset{\circ}{O}(x_0) \quad x < x_0 \quad \exists \xi = \xi(x) \in (x, x_0):$
$$
\frac{r_n(x)}{\phi(x)} = \frac{r_n^{(n-1)}(\xi)}{\phi^{(n-1)}(\xi)}
$$
$\forall x \in \overset{\circ}{O}(x_0) \quad \exists \xi \not= x_0:$
$$
\frac{r_n(x)}{\phi(x)} = \frac{r_n^{(n-1)}(\xi) - r_n^{(n-1)}(x_0)}{n!(\xi - x_0)}, \quad r_n^{(n-1)}(x_0) = 0 \Rightarrow
$$
$\xi = \xi(x)\cquad \xi(x) < x_0 \quad \forall x \in O(x_0) \quad x < x_0$
$$
\lim_{x \to x_0} \xi(x) = x_0, \quad \text{т.к.} \quad x < \xi(x) < x_0 \quad \Rightarrow
$$
Теорема о замене переменной под знаком предела $\Rightarrow$
$$
\lim_{x \to x_0} \frac{r_n(x)}{\phi(x)} = \frac{1}{n!} \lim_{\xi \to x_0} \frac{r_n^{(n-1)}(\xi) - r_n^{(n-1)}(x_0)}{\xi - x_0} = \frac{1}{n!} r_n^{(n)}(x_0) = 0
$$
Функция $\alpha(x) = \frac{r_n(x)}{\phi(x)}, \ x \in \overset{\circ}{O}(x_0)$ "--- бесконечно малая функция при $x \to x_0 \quad \Rightarrow r_n(x) = \alpha(x)\phi(x) = \alpha(x)(x - x_0)^n  = o((x - x_0)^n)$, при $x \to x_0 \quad \Rightarrow \text{формула}\ \eqref{ch5.2eq2}$.
\end{proof}

\section[Другой подход к доказательству формул Тейлора с остаточным членом в форме Пеано или Лагранжа]{Другой подход к доказательству формул Тейлора с остаточным членом в форме Пеано или Лагранжа\footnote{При составлении материала мнения редколлегии разделились. Уже изложенные доказательства привлекают своей математической красотой и логичностью, но под собой имеют много фундамента и достаточно сложные. Доказательства же в этом параграфе просты и легко запоминаются. Поэтому мы решили опубликовать оба подхода.}}

\begin{lemm}\label{ch5:simplemm}
Пусть существуют $f^{(n)}(x_0)$, $f'$ на $\overset{\circ}{O}(x_0)$. Тогда в $\overset{\circ}{O}(x_0)$

$$
(r_n(f;x))'=r_{n-1}(f';x).
$$
\end{lemm}
\begin{proof}
Поскольку $f^{(k)}(x_0)$ "--- суть число, то $$\left(\frac{f^{(k)}(x_0)}{k!} (x - x_0)^k\right)' =  \frac{f^{(k)}(x_0)}{(k-1)!} (x - x_0)^{k-1}$$ и верна следующая последовательность равенств
\begin{multline*}
(r_n(f;x))' = \left(f(x) - \sum_{k = 0}^{n} \frac{f^{(k)}(x_0)}{k!} (x - x_0)^k \right)' =
\\ = f'(x) - \sum_{k = 1}^{n} \frac{f^{(k)}(x_0)}{(k-1)!} (x - x_0)^{k-1}= f'(x) - \sum_{k = 0}^{n-1} \frac{{f'} ^{(k)}(x_0)}{k!} (x - x_0)^k =\\=r_{n-1}(f';x). \tag*{\qedhere}
\end{multline*}
\end{proof}

\begin{lemm}\label{ch5:lemmlinpribp}
Если функция $f(x)$ дифференцируема в точке $x_0$, то
\begin{equation}\label{ch5:linpribp}
f(x) = f(x_0) + f'(x_0) (x-x_0) + o(x-x_0),
\end{equation}
\end{lemm}
\begin{proof}
Фактически, нужно показать, что
\begin{equation}\label{ch5:linpribp2}
f(x) = f(x_0) + f'(x_0) (x-x_0) + \alpha(x)(x-x_0), \text{ где } \alpha(x)\xrightarrow{x\to x_0} 0.
\end{equation}	
Зададим функцию $\alpha(x)$ следующим образом. Пусть $\alpha(x_0) = 0$, а для $x\ne x_0$ 
$$
\alpha(x) = \frac{f(x) - f(x_0)}{x-x_0} - f'(x_0). 
$$
Тогда, очевидно, $\alpha(x)\xrightarrow{x\to x_0} 0$ (более того, она непрерывна в точке $x_0$) и выполняется равенство \eqref{ch5:linpribp}, в котором $o(x-x_0) = \alpha(x)(x-x_0)$.
\end{proof}
\begin{thm}[формула Тейлора с остаточным членом в форме Пеано]
Если функция $f$ дифференцируема $n$ раз в точке $x_0 \in \bbR$, то справедливо равенство
\begin{equation} \label{ch5:eq:Peano}
f(x) = \sum_{k = 0}^{n} \frac{f^{(k)}(x_0)}{k!} (x - x_0)^k + o((x - x_0)^n), \quad \text{при } x \to x_0,
\end{equation}
где $\psi(x) = o((x - x_0)^n),\ x \to x_0 \Longleftrightarrow \psi(x) = \alpha(x) (x - x_0)^n,$ где $\lim\limits_{x \to x_0} \alpha(x) = 0$.
\end{thm}
\begin{proof}
Фактически, нужно показать, что $r_n(f;x)$ может быть представлен в виде
$$
r_n(f;x) = o((x-x_0)^n)
$$
Будем доказывать последнюю формулу, применяя индукцию. При $n=1$ данное утверждение верно. Действительно, в этом случае функция $f$ дифференцируема в точке $x_0$. Следовательно, согласно лемме \ref{ch5:lemmlinpribp}
$$
f(x) - f(x_0) = f'(x_0) (x-x_0) + o(x-x_0),\quad x\to x_0,
$$
что совпадает с утверждением теоремы и с равенством $r_1(f;x)=o(x-x_0)$.

Предположим, что утверждение теоремы верно при $n-1$ $(n\ge 2)$ вместо $n$ и покажем, что оно верно в приведённой форме. Используя теорему Лагранжа о конечных приращениях и лемму \ref{ch5:simplemm}, имеем (считая, для определенности, что $x > x_0$)
$$
r_n(f;x) = r_n(f;x) - \underbrace{r_n(f;x_0)}_{=0} = r_{n-1} (f';\xi) (x-x_0), \text{ где } x_0<\xi<x.
$$

По предположению индукции $r_{n-1}(f'; \xi) = o((\xi-x_0)^{n-1}) = o((x-x_0)^{n-1})$ при $x\to x_0$ ($\xi$ просто переобозначили за $x$). Следовательно, 
$$
r_n(f;x) = o((x-x_0)^n) \text{ при } x\to x_0.
$$

Теорема доказана.
\end{proof}

\begin{thm}[формула Тейлора с остаточным членом в форме Лагранжа]
Если функция $f(x)$ в некоторой окрестности $O(x_0)$ точки $x_0$ имеет непрерывную производную $n$-го порядка и $f^{(n)}(x)$ дифференцируема в проколотой окрестности $\overset{\circ}{O}(x_0)$, то для любого
$x \in \overset{\circ}{O}(x_0)$ существует $\xi$, лежащее строго между $x$ и $x_0$ и такое, что справедливо равенство
\begin{equation}
f(x) = \sum_{k = 0}^{n} \frac{f^{(k)}(x_0)}{k!}(x - x_0)^k + \frac{f^{(n + 1)}(\xi)}{(n + 1)!}(x - x_0)^{n + 1}.
\end{equation}
\end{thm}

\begin{proof}
Фактически, нужно показать, что $r_n(f;x)$ может быть представлен в виде
$$
r_n(f;x) = \frac{f^{(n + 1)}(\xi)}{(n + 1)!}(x - x_0)^{n + 1}.
$$

Будем доказывать последнюю формулу, применяя индукцию. Рассмотрим случай $x>x_0$ (случай $x<x_0$ аналогичен). При $n=0$ выше указанная формула утверждает, что существует $\xi\in(x_0,x)$, при котором
$$
f(x) = f(x_0) + f'(\xi)(x-x_0).
$$
Это утверждение верно, так как оно совпадает с доказанной в главе~\textnumero\ref{chapter4} формулой приращений Лагранжа.

Предположим, что утверждение верно при $n-1$ $(n \ge 1)$ вместо $n$ и установим, что оно верно в приведённом виде. Используя теорему Коши о среднем и лемму~\ref{ch5:simplemm}, имеем
\begin{multline*}
\frac{r_n(f;x)}{(x-x_0)^{n+1}} = \frac{r_n(f;x) - \overbrace{r_n(f;x_0)}^{=0}}{(x-x_0)^{n+1} - {\underbrace{(x_0-x_0)}_{=0}}^{n+1}} = \frac{r_{n-1}(f';\xi)}{(n+1)(\xi-x_0)^{n}} =\\ 
= \frac{{f'}^{(n)} (\eta)}{n!(n+1)} =  \frac{{f}^{(n+1)} (\eta)}{(n+1)!},
\end{multline*}
где $x_0<\eta<\xi<x$, а предпоследнее равенство написано в силу предположения индукции.

Теорема доказана.
\end{proof}

\section{Теорема о единственности разложения функции по формуле Тейлора}

\begin{thm}[о единственности разложения функции по формуле Тейлора]
Пусть функция $f$ дифференцируема $n$ раз в точке $x_0 \in \bbR$
\begin{equation} \label{ch5.3.eq3}
f(x) = \sum_{k = 0}^{n}a_k (x - x_0)^k + o((x - x_0)^n), \quad x \to x_0 
\end{equation}
Тогда $a_k = \dfrac{f^{(k)}(x_0)}{k!}, \quad \forall k \in \overline{0, n}$
\end{thm}

\begin{proof}
$f$ "--- дифференцируема $n$ раз в точке $x_0 \ \Rightarrow$
Справедлива Формула Тейлора с остаточным членом в форме Пеано:
\begin{equation} \label{eq5.3eq4}
f(x) = \sum_{k = 0}^{n} \frac{f^{(k)}(x_0)}{k!} \cdot (x - x_0)^k + o((x - x_0)^n) \quad \text{при} \quad x \to x_0
\end{equation}

Если из \eqref{ch5.3.eq3} вычесть \eqref{eq5.3eq4}, получим
\begin{equation} \label{eq5.3.eq5}
\sum\limits_{k = 0}^{n} \left( \frac{f^{(k)}(x_0)}{k!} - a_k \right) (x - x_0)^k = o((x - x_0)^n)
\end{equation}
В \eqref{eq5.3.eq5} левая и правая часть имеют пределы при $x \to x_0$, которые равны между собой.

$\frac{f^{(0)}(x_0)}{0!} - a_0 = 0 \quad \Rightarrow \quad a_0 = \frac{f^{(0)}(x_0)}{0!}$

$\eqref{eq5.3eq4} \quad \Rightarrow \quad \sum\limits_{k = 1}^{n} \left( \frac{f^{(k)}(x_0)}{k!} - a_k \right) (x - x_0)^{k - 1} = o((x - x_0)^{n - 1})$

$\lim\limits_{x \to x_0} \quad \Rightarrow \quad \frac{f^{(1)}(x_0)}{1!} - a_1 = 0 \quad \Rightarrow \quad a_1 = \frac{f^{(1)}(x_0)}{1!}$

Делая так $n$ раз, получим $a_n = \frac{f^{(n)}(x_0)}{n!}$.
\end{proof}

