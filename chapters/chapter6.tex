\chapter{Исследование функций одной переменной при помощи первой и второй производных на монотонность, локальные экстремумы, выпуклость. Необходимые условия, достаточные условия.}

\section{Исследование функций одной переменной при помощи первой и второй производных на монотонность}

Имеет место следующее следствие из \hyperref[ch4t1]{теоремы Лагранжа о среднем}
\begin{thm}[Критерий постоянства дифференцируемой функции]
Если функция $f(x)$ дифференцируема на интервале, то $f(x)$ постоянна на $(a;b)$ тогда и только тогда, когда $f'(x)=0$ на $(a;b)$.
\end{thm}
 
\begin{thm}[Критерий возрастания/убывания дифференцируемой функции] Если функция $f(x)$ дифференцируема на интервале $(a;b)$, то $f(x)$ возрастает (убывает) на $(a;b)$ тогда и только тогда, когда $f'(x)\ge 0$ (соотв., $f'(x)\le 0$) на $(a;b)$.
\end{thm}
\begin{proof} Если $f(x)$ возрастает на $(a;b)$, то для любых $x$ и $x+\Delta x$ из $(a;b)$ разность $\Delta f = f(x+\Delta x) - f(x)$ имеет тот же знак, что и $\Delta x$, и поэтому всегда $\frac{\Delta f}{\Delta x} \ge 0$. Отсюда в пределе при $\Delta x \to 0$ следует, что $f'(x) \ge 0$. Аналогично, если $f(x)$ убывает на $(a;b)$, то $\frac{\Delta f}{\Delta x} \le 0$, и поэтому $f'(x) \le 0$ на $(a;b)$.

    Наоборот, для любых $x$ и $x + \Delta x$ из $(a;b)$, по \hyperref[ch4t1]{теореме Лагранжа}, существует $\xi$ такое, что $\Delta f = f'(\xi)\Delta x$. Поэтому, если $f'(x) \ge 0$ ($\le 0$) на $(a;b)$, то $f(x)$ возрастает (убывает) на $(a;b)$.

Теорема доказана.
\end{proof}

\begin{thm} [Достаточное условие строго возрастания/убывания дифференцируемой функции] Если функция $f(x)$ на интервале $(a;b)$ дифференцируема и $f'(x) > 0$ ($< 0$) на $(a;b)$, то она строго возрастает (убывает) на $(a;b)$.
\end{thm}
\begin{proof}
    По \hyperref[ch4t1]{теореме Лагранжа}, для любых $x$ и $x + \Delta x$ из $(a; b)$ существует $\xi$ такое, что
$$
f(x+\Delta x)-f(x)=f'(\xi)\Delta x.
$$
Отсюда следует, что если $f'(x) > 0$, то $f(x)$ строго возрастает, а если $f'(x) < 0$, то $f(x)$ строго убывает на $(a;b)$. 

Теорема доказана.
\end{proof}
Заметим, что условие: $f'(x) > 0$ на $(a;b)$, являясь достаточным, не является необходимым для строго возрастания дифференцируемой функции $f(x)$ на $(a;b)$. Например, функция $f(x) = x^3$ строго возрастает на $\bbR$, но $f'(0) = 0$.

\section{Исследование функций одной переменной при помощи первой и второй производных на локальные экстремумы}
Точки экстремума и экстремальные значения функции (локальные минимумы и локальные максимумы) определялись в главе~\textnumero\ref{chapter4}. Там же была доказана теорема \hyperref[ch4n1]{Ферма}:

\begin{thm}[необходимое условие экстремума дифференцируемой функции]
Если функция $f(x)$ в точке $x_0$ дифференцируема и $x_0$ является точкой экстремума для $f(x)$, то $f'(x_0) = 0$.
\end{thm}

Заметим, что условие $f'(x_0) = 0$, являясь необходимым, не является достаточным для того, чтобы точка $x_0$ была экстремальной для $f(x)$. Например, для$ f(x) = x^3$ имеем: $f'(0) = 0$; но точка $x_0 = 0$ не является экстремальной.

\begin{defn} Точка $x_0$ называется \textit{стационарной точкой функции}~$f(x)$, если $f(x)$ в точке $x_0$ дифференцируема и $f'(x_0) = 0$. Если же $f'(x_0) > 0$ ($< 0$), то $x_0$ называется точкой возрастании (убывания) функции $f(x)$.
\end{defn}

Из \hyperref[ch4n1]{теоремы Ферма} следует, что точки экстремумов данной функции следует искать среди так называемых, \textit{критических точек}, т.е. среди стационарных точек и точек, в которых нет производной.

\begin{defn}Точка $x_0 \in D_f$ называется \textit{точкой строгого максимума (минимума) функции} $f(x)$, если существует окрестность $\dnei{x_0}$ точки $x_0$ такая, что
$$
\forall x \in \dnei{x_0}\cap D_f \quad f(x) < f(x_0) \quad(\text{соотв.} f(x) > f(x_0)).
$$
\end{defn}

Точки строгого максимума и минимума функции называют \textit{точками строгого экстремума} этой функции.

\begin{thm}[достаточное условие экстремума дифференцируемой функции] Пусть функция $f(x)$ непрерывна на интервале $(a;b)$ и дифференцируема на интервалах $(a;x_0)$ и $(x_0;b)$. Тогда, если $f'(x) > 0$ на $(a;x_0)$ и $f'(x) < 0$ на $(x_0;b)$, то $x_0$ "--- точка строгого максимума, а если $f'(x) < 0$ на $(a;x_0)$ и $f'(x) > 0$ на $(x_0;b)$, то $x_0$ "--- точка строгого минимума функции $f(x)$.
\end{thm}
\begin{proof}
    Пусть выполнено $f'(x) > 0$ на $(a;x_0)$ и $f'(x) < 0$ на $(x_0;b)$. Пусть $x \in (a;x_0) \Rightarrow$ на $[x;x_0]$ выполняются все условия \hyperref[ch4t1]{теоремы Лагранжа}. $\Rightarrow \exists \xi \in (x;x_0):$ 
$$
f(x_0)-f(x) = \underbrace{f'(\xi)}_{>0} \underbrace{(x_0-x)}_{>0} >0 \Rightarrow \forall x \in (a;x_0)\quad f(x_0) > f(x).
$$
Аналогично, пусть $x\in(x_0;b)$. Тогда $\exists \xi \in (x_0;x):$
$$
f(x_0)-f(x) = \underbrace{f'(\xi)}_{<0} \underbrace{(x_0-x)}_{<0} >0 \Rightarrow \forall x \in (x_0;b) \quad f(x_0) > f(x).
$$
Т.е. $x_0$ "--- точка строго максимума функции $f$.

Теорема доказана.
\end{proof}
Доказанную теорему образно формулируют следующим образом. \textit{Если при переходе через точку $x_0$ производная $f'(x)$ меняет знак с плюса на минус, то $x_0$ "--- точка максимума, а если с минуса на плюс, то $x_0$ "--- точка минимума функции $f(x)$.}
\begin{thm} [достаточное условие экстремума дифференцируемой функции] Пусть функция $f(x)$ в точке $x_0$ имеет конечную производную 2-го порядка. Тогда, если $f'(x_0) = 0$, а $f''(x_0) > 0$ \textup{($<0$)}, то $x_0$ "--- точка строгого минимума (максимума) функции $f(x)$.
\end{thm}

\begin{proof}
По формуле Тейлора с остаточным членом в форме Пеано имеем:	
$$
f(x)=f(x_0)+\left(\frac{1}{2}f''(x_0)+\alpha(x)\right)(x-x_0)^2,
$$
где $\alpha \to 0$ при $x \to x_0$.
 
Если $f''(x_0) > 0$, то $\exists O(x_0)\cquad \forall x\in\dnei{x_0}\quad\frac{1}{2}f''(x_0)+\alpha(x)>0$
и поэтому $f(x) > f(x_0)\quad \forall \dnei{x_0}$. Следовательно, $x_0$ "--- точка строгого минимума функции $f(x)$.
Аналогично доказывается, что если $ f''(x_0) < 0$, то $x_0$ — точка строгого максимума функции $f(x)$.

Теорема доказана.
\end{proof}


\section{Исследование функций одной переменной при помощи первой и второй производных на выпуклость}

\begin{defn}
Функция $f(x)$ называется \textit{выпуклой вниз на промежутке} $\Delta\subset D_f$, если для любых $x_1,x_2\in\Delta$ и любых положительных $\alpha_1$ и $\alpha_2$ таких, что $\alpha_1+\alpha_2=1$, справедливо неравенство
\begin{equation} \label{vv1}
f(\alpha_1x_1+\alpha_2x_2) \le \alpha_1f(x_1)+\alpha_2f(x_2).
\end{equation}

Если же выполняется неравенство
\begin{equation} \label{vv2}
f(\alpha_1x_1+\alpha_2x_2) \ge \alpha_1f(x_1)+\alpha_2f(x_2),
\end{equation}
то функция $f(x)$ называется \textit{выпуклой вверх на промежутке} $\Delta$.

В этом случае промежуток $\Delta$ называется \textit{промежутком выпуклости вниз (вверх) функции} $f(x)$.
\end{defn}

Легко видеть, что если $x_1\neq x_2$, то любая точка $x_\alpha=\alpha_1x_1+\alpha_2x_2$, где $\alpha_1>0,\;\alpha_2>0$ и $\alpha_1+\alpha_2=1$, лежит строго между $x_1$ и $x_2$. И наоборот, любая точка $x$, лежащая строго между $x_1$ и $x_2$, может быть представлена в виде $x=\alpha_1x_1+\alpha_2x_2$, где $\alpha_1>0,\;\alpha_2>0$ и $\alpha_1+\alpha_2=1$.

Если в \eqref{vv1} (соотв. \eqref{vv2}) для $x_1\neq x_2$ выполнено строго неравенство, то функция $f(x)$ называется \textit{строго выпуклой вниз (вверх) на промежутке} $\Delta$, а промежуток $\Delta$ называется \textit{промежутком строгой выпуклости вниз \textup{(вверх}) функции} $f(x)$.

\begin{thm}
Если функция $f(x)$ дифференцируема на интервале $(a;b)$ и $f'(x)$ убывает (возрастает) на $(a,b)$, то $f(x)$ выпукла вверх (вниз) на $(a,b)$. Если же $f'(x)$ строго убывает (возрастает) на $(a;b)$, то $f(x)$ строго выпукла вверх (вниз) на $(a,b)$.
\end{thm}

\begin{proof}
Пусть $x_1,x_2\in(a;b)$ и, для определенности, $x_1<x_2$. Пусть, далее, $\alpha_1, \alpha_2$ "--- положительные числа, $\alpha_1+\alpha_2=1$. Тогда точка $x_\alpha=\alpha_1x_1+\alpha_2x_2$ удовлетворяет неравенствам $x_1<x_\alpha<x_2$.

По \hyperref[ch4t1]{теореме о среднем Лагранжа} имеем
$$
\exists \xi_1\in(x_1;x_\alpha)\cquad f(x_\alpha)-f(x_1)=f'(\xi_1)(x_\alpha-x_1),\\
$$
$$
\exists \xi_2\in(x_\alpha;x_2)\cquad f(x_2)-f(x_\alpha)=f'(\xi_2)(x_2-x_\alpha).
$$

Первое равенство умножим на $\alpha_1$, второе  "--- на $\alpha_2$, а затем из первого вычтем второе. В результате получим равенство
$$
f(x_\alpha)-\alpha_1f(x_1)-\alpha_2f(x_2)=f'(\xi_1)\alpha_1(x_\alpha-x_1)-f'(\xi_2)\alpha_2(x_2-x_\alpha).
$$

Заметим, что 
$$
x_\alpha-x_1=\alpha_1x_1+\alpha_2x_2-x_1=-\alpha_2x_1+\alpha_2x_2=\alpha_2(x_2-x_1)
$$
и, аналогично, $x_2-x_\alpha=\alpha_1(x_2-x_1)$, поэтому
$$
f(x_\alpha)-\alpha_1f(x_1)-\alpha_2f(x_2)=\alpha_1\alpha_2(x_2-x_1)(f'(\xi_1)-f'(\xi_2)),
$$
где $\xi_1<\xi_2$. Следовательно, если $f'(x)$ убывает (возрастает), то 
$$
f(x_\alpha)-\alpha_1f(x_1)-\alpha_2f(x_2)\ge 0 \quad(\le 0).
$$

Это и доказывает, что функция $f(x)$ выпукла вверх (соотв. вниз) на интервале $(a;b)$.
\end{proof}
\begin{cons}
Если функция $f(x)$ дважды дифференцируема и $f''(x)\le 0\;(\ge 0)$ на интервале $(a;b)$, то $f(x)$ выпукла вверх (соотв., вниз) на $(a;b)$. Если же $f''(x)<0\;(>0)$ на $(a;b)$, то $f(x)$ строго выпукла вверх (соотв., вниз) на $(a;b)$.
\end{cons}


Пусть функция $y=f(x)$ определена в некоторой окрестности точки $x_0$ и в этой точке она имеет касательную.

\begin{defn}
Если существует окрестность $O(x_0)$ точки $x_0$ такая, что любая точка графика функции $y=f(x)$ при $x\in O(x_0)$ лежит на касательной или выше (ниже) касательной в точке $x_0$, то $x_0$ называется \textit{точкой выпуклости вниз (вверх) функции} $f(x)$.
\end{defn}

\begin{defn}
Точка $x_0$ называется \textit{точкой строгой выпуклости вниз (вверх)} функции $y=f(x)$, если существует окрестность $O(x_0)$ точки $x_0$ такая, что любая точка графика этой функции при $x\in O(x_0)$, $x\neq x_0$, лежит выше (ниже) касательной в точке $x_0$.
\end{defn}


\begin{defn}
Если существует окрестность $O(x_0)=(a;b)$ точки~$x_0$ такая, что точки графика функции $y=f(x)$ при $x\in (a;x_0)$ лежат по одну сторону от касательной и, может быть, на касательной, а при $x\in(x_0;b)$ "--- по другую сторону и, может быть, на касательной, то $x_0$ называется \textit{точкой перегиба функции} $f(x)$

Если же точки графика функции $f(x)$ при $x\in(a;x_0)$ лежат строго по одну сторону от касательной, а при $x\in (x_0;b)$ "--- строго по другую сторону, то $x_0$ называется \textit{точкой строгого перегиба функции} $f(x)$.
\end{defn}

\begin{thm}
Пусть функция~$f(x)$ в точке $x_0$ имеет конечную вторую производную. Тогда, если $f''(x_0)>0\; (<0)$, то точка $x_0$ является точкой строгой выпуклости вниз (вверх) функции $f(x)$. 
\end{thm}

\begin{proof}
Утверждение следует из формулы Тейлора:
$$
f(x)=f(x_0)+f'(x_0)(x-x_0)+\frac{1}{2}f''(x_0)(x-x_0)^2+\alpha(x)(x-x_0)^2,
$$
где $\alpha(x)=o(1)$ при $x\to x_0$. Действительно, если $f''(x_0)>0$, то существует окрестность $O(x_0)$ точки $x_0$ такая, что для любого $x\neq x_0$ из этой окрестности
$$
\frac{1}{2}f''(x_0)+\alpha(x)>0
$$
и, следовательно, 
$$
f(x)>f(x_0)+f'(x_0)(x-x_0),
$$
т.е. точки графика функции $y=f(x)$ для $x\in\dnei {x_0}$ лежат выше касательной в точке $x_0$. Аналогично, если $f''(x_0)<0$, то
\begin{equation*}
\exists O(x_0)\cquad \forall x\in \dnei {x_0} \quad f(x)<f(x_0)+f'(x_0)(x-x_0). \qedhere
\end{equation*}
\end{proof}

\begin{cons}
Пусть функция $f(x)$ в точке $x_0$ имеет конечную производную второго порядка. Тогда, если $x_0$ является точкой перегиба для $f(x)$, то $f''(x_0)=0$.
\end{cons}

\begin{thm}
Пусть функция $f(x)$ имеет непрерывную производную на интервале $(a;b)$, содержащем точку $x_0$, и дважды дифференцируема на интервалах $(a;x_0)$ и $(x_0;b)$. Тогда, если $f''(x)$ на $(a;x_0)$ положительна, а на $(x_0;b)$ отрицательна, или наоборот, то $x_0$ "--- точка строгого перегиба функции $f(x)$. 
\end{thm}

\begin{proof}
Для функции $f(x)$ напишем формулу Тейлора с остаточным членом в форме Лагранжа:
$$
f(x)=f(x_0)+f'(x_0)(x-x_0)+\frac{1}{2}f''(\xi)(x-x_0)^2,
$$
где $\xi$ лежит между $x$ и $x_0$. Из нее видно, что если $f''(x)$ имеет разные знаки на $(a;x_0)$ и $(x_0;b)$, то график функции перегибается через касательную.
\end{proof}

Таким образом, равенство нулю второй производной является \textit{необходимым условием}, а смена знака второй производной "--- \textit{достаточным условием точки перегиба} функции.
