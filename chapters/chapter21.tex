\part[Линейная алгебра]{Линейная алгебра}

\font\Large=cmr10 at 13pt
\newcount\rowcount\rowcount=3
\def\fudge#1{\smash{\hbox{\Large#1}}}
\def\doublyso{\kern+2em\smash{\vrule height \rowcount em depth .2em}\hidewidth}			%for matrix

\chapter{Общее решение системы линейных алгебраических уравнений. Теорема Кронекера"--~Капелли.}\label{chapter21}
\section{Теорема Кронекера"--~Капелли}

Рассмотрим \textit{систему линейных уравнений}
\begin{equation}\label{21.1.sys1}
\left\lbrace\begin{array}{crl}
a_{11}x_1+a_{12}x_2+\ldots+a_{1n}x_n=b_1\\
a_{21}x_1+a_{22}x_2+\ldots+a_{2n}x_n=b_2\\
\ldots \\
a_{m1}x_1+a_{m2}x_2+\ldots+a_{mn}x_n=b_m\\ 
\end{array}\right.\end{equation}
Эту систему можно записать в матричном виде:
\begin{equation*}\tag{\ref{21.1.sys1}'}
AX=b^{\uparrow},
\end{equation*}
\begin{equation*}
A=\begin{pmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\hdotsfor{4} \\
a_{m1} & a_{m2} & \cdots & a_{mn} \\
\end{pmatrix},
b^\uparrow=\begin{pmatrix}
b_1 \\ b_2 \\ \vdots \\ b_m \\
\end{pmatrix},
X=\begin{pmatrix}
x_1 \\ x_2 \\ \vdots \\ x_n \\
\end{pmatrix}
\end{equation*}
$A$ называется \textit{основной матрицей системы}, $b^\uparrow$ "--- \textit{столбцом свободных членов}, $\widetilde A = (A|b^\uparrow)$ "--- \textit{расширенной матрицей системы}.
\begin{defn}
Набор векторов $\vv{a_1}$,$\vv{a_2}$,...,$\vv{a_r}$ называется \textit{базисом} множества векторов $V\neq \emptyset$, если

(1) $\vv{a_1}$,\ldots,$\vv{a_r}$ линейно независимы

(2) $\forall v \in V \exists \lambda_1,...\lambda_r: v=\sum \limits_{i=1}^r\lambda_ia_i$
\end{defn}

\begin{defn}
Упорядоченный набор чисел ($x_1, x_2, \ldots, x_n$) называется \textit{частным решением} системы \eqref{21.1.sys1}, если при его подстановке в неё получается верное равенство. \textit{Общим решением} \eqref{21.1.sys1} называется совокупность всех её решений. Система называется \textit{совместной}, если имеет хотя одно решение.
\end{defn}
\begin{defn}
\textit{Рангом конечного набора векторов} называется количество векторов в базисе этого набора. \textit{Рангами матрицы по строкам} и \textit{по столбцам} называются ранги соответственно набора строк и набора столбцов матрицы.
\end{defn}
\begin{lemm} [о ранге матрицы]
Для любой матрицы $A$ равны между собой её ранг по столбцам, ранг по строкам и количество строк в неупрощаемом виде (виде после отработки алгоритма Гаусса).
\end{lemm}
В силу этого свойства, говорят просто о \textit{ранге матрицы} $\rg A$.
\begin{thm}[Кронекера"--~Капелли\rindex{теорема!Кронекера"--~Капелли}]
Система линейных уравнений~\eqref{21.1.sys1} совместна тогда и только тогда, когда $\rg A = \rg \widetilde A$.
\end{thm}
\begin{proof}
$\Rightarrow$: Пусть система совместна. Это означает, что
\begin{equation*}
\exists x_1,\ldots, x_n: x_1a_1^\uparrow +\ldots+x_na_n^\uparrow=b^\uparrow,
\end{equation*}
где через $a_k^\uparrow$ обозначен k-й столбец матрицы $A$. Следовательно, базис столбцов матрицы $A$  является и базисом столбцов матрицы $\widetilde A$ и $\rg A = \rg \widetilde A$.
$\Leftarrow$: Пусть $\rg A = \rg \widetilde A$, а столбцы $a_{j_1}^\uparrow,...,a_{j_r}^\uparrow$ образуют базис матрицы $A$. Этот набор в совокупности с $b^\uparrow$ не может образовать линейно независимый набор, т.к. это повлечёт увеличение ранга, следовательно, 
\begin{equation*}\\ 
\exists x_{j_1},...,x_{j_r}: -b^\uparrow+x_{j_1}a_{j_1}^\uparrow+\ldots+x_{j_r}a_{j_r}^\uparrow+\sum_{j \notin \{j_1,...,j_r\}}0 a_j^\uparrow = 0,
\end{equation*} 
что означает, что решение существует.
\end{proof}
\section{Общее решение системы линейных алгебраических уравнений}
Напомним, что для приведения матриц к \textit{ступенчатому виду} \eqref{21.2.stairs} используется прямой ход алгоритма Гаусса. 
\begin{equation}\label{21.2.stairs} 
\begin{pmatrix}
  &a_{1,j_1}& \hdotsfor{4}          &a_{1,n}     \cr 
\fudge 0&&a_{2,j_1} &\hdotsfor{3}      &a_{2,n}     \cr
  &   &     &\ddots&\hdotsfor{2}    &\vdots      \cr 
  &\fudge 0 && & a_{r,j_r}  &\cdots &a_{r,n}   \cr \hline
  &   &     &  &            &       &         \cr
  &   &     &  &\fudge 0    &       &         \cr
\end{pmatrix}
\end{equation}    
Затем применяется обратный ход алгоритма Гаусса для приведения к \textit{неупрощаемой форме}, которая при перестановке столбцов имеет вид \eqref{21.2.simplest1}.
\begin{equation}\label{21.2.simplest1}
\begin{pmatrix}
  & 1 &     &   &a'_{1,r+1} &\cdots &a'_{1,n}   \cr 
\fudge 0 & &\ddots& &\vdots &\cdots &\vdots     \cr
  &   &     & 1 &a'_{r,r+1} &\cdots &a'_{r,n}   \cr \hline
  &   &     &   &           &       &           \cr
  &   & &\fudge 0  &        &       &           \cr
\end{pmatrix}
\end{equation}    
\begin{thm}\label{21.2.th.common}
Общее решение совместной системы линейных уравнений \eqref{21.1.sys1} имеет вид 
\begin{equation}\label{21.2.common}
Y=X_0+\sum_{j=1}^{n-r}c_jX_j, c_j \in \bbR,
\end{equation}
где $X_0$ "--- частное решение, $X_1,...,X_{n-r}$ "--- линейно независимые решения однородного уравнения $AX=0$, a $r=\rg A=\rg \widetilde A$ - ранг матрицы уравнения.
\end{thm}
\begin{proof}
Прямой и обратный ход алгоритм Гаусса приводят расширенную матрицу системы (возможно, с переобозначением $x_{i_1}\rightarrow x'_1,...,x_{i_r}\rightarrow x'_r,...$) к неупрощаемому виду
\begin{equation}\label{21.2.simplest2}
\bordermatrix{
\global\everycr{\noalign{\global\advance\rowcount by 1}}
& 1 &      & r & r+1       &       & n       & \cr
1 & 1 &      &   &a'_{1,r+1} &\cdots &a'_{1,n} & b'_1    \cr 
  &   &\ddots&   &\vdots     &\cdots &\vdots   & \vdots  \cr
r &   &      & 1 &a'_{r,r+1} &\cdots &a'_{r,n} & b'_r    \cr \hline
  &   &      &   &           &       &         &         \cr 
  &   &      &   &\fudge 0   &       &\doublyso&\fudge 0 \cr 
},
\everycr={}
\end{equation}
что соответствует системе

$\begin{cases}
x'_1+\sum \limits_{j=r+1}^n a'_{1j}x'_j=b'_1\\
x'_2+\sum \limits_{j=r+1}^n a'_{2j}x'_j=b'_2\\
\ldots \\
x'_r+\sum \limits_{j=r+1}^n a'_{rj}x'_j=b'_r\\ 
\end{cases}
\Leftrightarrow
\begin{cases}
x'_1=b'_1-\sum \limits_{j=r+1}^n a'_{1j}x'_j\\
x'_2=b'_2-\sum \limits_{j=r+1}^n a'_{2j}x'_j\\
\ldots \\
x'_r=b'_r-\sum \limits_{j=r+1}^n a'_{rj}x'_j\\ 
\end{cases}$

$x'_1,...x'_r$ называются \textit{главными} неизвестными, $x'_{r+1},...,x'_n$ "--- \textit{свободными}, или \textit{параметрическими}, т.к. выбор последних произволен.

Введём обозначения:
\begin{equation}
X'_0=\begin{pmatrix} b'_1\\ \vdots \\b'_r \\ \hline \\ \fudge 0 \\ \\ \end{pmatrix}, 
X'_j=\bordermatrix{
  & \cr
  & -a'_{1,r+j} \cr
  & \vdots  \cr
  & -a'_{r,r+j} \cr \hline
  &   \cr
  & \fudge 0 \cr
r+j& 1 \cr
  & \fudge 0 \cr
}, j=\overline{1,n-r}
\end{equation}

Тогда решение имеет вид
\begin{equation*}
Y'=X'_0+\sum_{j=1}^{n-r}x'_{r+j}X'_j,$$
где 
$$ x'_{r+j} \in \bbR, j = \overline{1,n-r}.
\end{equation*}
Остаётся лишь перейти к исходным переменным и получить выражение \ref{21.2.common}, где $c_j=x'_{r+j}$.
\end{proof}